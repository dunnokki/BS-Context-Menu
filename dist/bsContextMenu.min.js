(function(){'use strict';const CONTEXT_MENU_ATTR='data-bs-context-menu';const CONTEXT_MENU_CLASS='context-menu';const SHOW_CLASS='show';let activeMenu=null;let lastRightClickedElement=null;function init(){injectStyles();ensureTriggersAreFocusable();document.addEventListener('contextmenu',handleContextMenu);document.addEventListener('click',handleClickOutside);document.addEventListener('keydown',handleKeyDown);window.addEventListener('scroll',hideActiveMenu,true);window.addEventListener('resize',hideActiveMenu)}function injectStyles(){if(document.getElementById('bs-context-menu-styles')){return}const styles=document.createElement('style');styles.id='bs-context-menu-styles';styles.textContent=`
      .${ CONTEXT_MENU_CLASS } {
        position: fixed;
        z-index: 1080;
        display: none;
        min-width: 10rem;
        padding: 0.5rem 0;
        margin: 0;
        font-size: 1rem;
        color: var(--bs-body-color);
        text-align: left;
        list-style: none;
        background-color: var(--bs-body-bg);
        background-clip: padding-box;
        border: var(--bs-border-width) solid var(--bs-border-color-translucent);
        border-radius: var(--bs-border-radius);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
      }

      .${ CONTEXT_MENU_CLASS }.${ SHOW_CLASS } {
        display: block;
      }

      .${ CONTEXT_MENU_CLASS } ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .${ CONTEXT_MENU_CLASS } .dropdown-item {
        display: block;
        width: 100%;
        padding: 0.25rem 1rem;
        clear: both;
        font-weight: 400;
        color: var(--bs-body-color);
        text-align: inherit;
        text-decoration: none;
        white-space: nowrap;
        background-color: transparent;
        border: 0;
        cursor: pointer;
        transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out;
      }

      .${ CONTEXT_MENU_CLASS } .dropdown-item:hover,
      .${ CONTEXT_MENU_CLASS } .dropdown-item:focus-visible {
        color: var(--bs-dropdown-link-hover-color, var(--bs-emphasis-color));
        background-color: var(--bs-dropdown-link-hover-bg, var(--bs-tertiary-bg));
        text-decoration: none;
      }

      .${ CONTEXT_MENU_CLASS } .dropdown-item:focus {
        outline: none;
      }

      .${ CONTEXT_MENU_CLASS } .dropdown-item.active,
      .${ CONTEXT_MENU_CLASS } .dropdown-item:active {
        color: var(--bs-dropdown-link-active-color, #fff);
        background-color: var(--bs-dropdown-link-active-bg, var(--bs-primary));
        text-decoration: none;
      }

      .${ CONTEXT_MENU_CLASS } .dropdown-item.disabled,
      .${ CONTEXT_MENU_CLASS } .dropdown-item:disabled {
        color: var(--bs-dropdown-link-disabled-color, var(--bs-secondary-color));
        pointer-events: none;
        background-color: transparent;
      }

      .${ CONTEXT_MENU_CLASS } .dropdown-divider {
        height: 0;
        margin: 0.5rem 0;
        overflow: hidden;
        border-top: 1px solid var(--bs-border-color-translucent);
      }

      .${ CONTEXT_MENU_CLASS } .dropdown-header {
        display: block;
        padding: 0.5rem 1rem;
        margin-bottom: 0;
        font-size: 0.875rem;
        color: var(--bs-secondary-color);
        white-space: nowrap;
      }
    `;document.head.appendChild(styles)}function ensureTriggersAreFocusable(){const triggers=document.querySelectorAll(`[${ CONTEXT_MENU_ATTR }]`);const nativelyFocusable=['A','BUTTON','INPUT','SELECT','TEXTAREA'];triggers.forEach(trigger=>{if(trigger.hasAttribute('tabindex')){return}if(nativelyFocusable.includes(trigger.tagName)&&(trigger.tagName!=='A'||trigger.hasAttribute('href'))){return}trigger.setAttribute('tabindex','0')})}function handleContextMenu(event){const trigger=event.target.closest(`[${ CONTEXT_MENU_ATTR }]`);if(!trigger){lastRightClickedElement=null;return}const menuId=trigger.getAttribute(CONTEXT_MENU_ATTR);if(!menuId){return}const menu=document.getElementById(menuId);if(!menu||!menu.classList.contains(CONTEXT_MENU_CLASS)){return}if(lastRightClickedElement===trigger){lastRightClickedElement=null;hideActiveMenu();return}lastRightClickedElement=trigger;event.preventDefault();event.stopPropagation();hideActiveMenu();showMenu(menu,event.clientX,event.clientY,trigger)}function showMenu(menu,x,y,trigger){activeMenu=menu;trigger.setAttribute('aria-expanded','true');menu.style.left=`${ x }px`;menu.style.top=`${ y }px`;menu.classList.add(SHOW_CLASS);menu._bsContextMenuTrigger=trigger;requestAnimationFrame(()=>{adjustMenuPosition(menu,x,y);const firstItem=menu.querySelector('.dropdown-item:not(.disabled):not(:disabled)');if(firstItem){firstItem.focus()}});menu.dispatchEvent(new CustomEvent('show.bs.contextmenu',{bubbles:true,detail:{trigger,x,y}}))}function adjustMenuPosition(menu,x,y){const rect=menu.getBoundingClientRect();const viewportWidth=window.innerWidth;const viewportHeight=window.innerHeight;let newX=x;let newY=y;if(x+rect.width>viewportWidth){newX=Math.max(0,viewportWidth-rect.width-5)}if(y+rect.height>viewportHeight){newY=Math.max(0,viewportHeight-rect.height-5)}menu.style.left=`${ newX }px`;menu.style.top=`${ newY }px`}function hideActiveMenu(){if(!activeMenu){return}const trigger=activeMenu._bsContextMenuTrigger;if(trigger){trigger.setAttribute('aria-expanded','false');trigger.focus()}activeMenu.classList.remove(SHOW_CLASS);activeMenu.dispatchEvent(new CustomEvent('hide.bs.contextmenu',{bubbles:true,detail:{trigger}}));activeMenu._bsContextMenuTrigger=null;activeMenu=null}function handleClickOutside(event){if(!activeMenu){return}if(activeMenu.contains(event.target)){if(event.target.closest('.dropdown-item')){event.preventDefault();lastRightClickedElement=null;hideActiveMenu()}return}lastRightClickedElement=null;hideActiveMenu()}function handleKeyDown(event){if(!activeMenu){return}switch(event.key){case 'Escape':event.preventDefault();hideActiveMenu();break;case 'ArrowDown':event.preventDefault();focusNextItem(1);break;case 'ArrowUp':event.preventDefault();focusNextItem(-1);break;case 'Enter':case ' ':if(document.activeElement?.classList.contains('dropdown-item')){event.preventDefault();document.activeElement.click()}break;case 'Tab':event.preventDefault();focusNextItem(event.shiftKey?-1:1);break}}function focusNextItem(direction){if(!activeMenu){return}const items=Array.from(activeMenu.querySelectorAll('.dropdown-item:not(.disabled):not(:disabled)'));if(items.length===0){return}const currentIndex=items.indexOf(document.activeElement);let nextIndex;if(currentIndex===-1){nextIndex=direction===1?0:items.length-1}else{nextIndex=(currentIndex+direction+items.length)%items.length}items[nextIndex]?.focus()}window.BSContextMenu={show(menuOrId,x,y,trigger=null){const menu=typeof menuOrId==='string'?document.getElementById(menuOrId):menuOrId;if(menu&&menu.classList.contains(CONTEXT_MENU_CLASS)){hideActiveMenu();showMenu(menu,x,y,trigger||document.body)}},hide(){hideActiveMenu()},getActiveMenu(){return activeMenu},refresh(){ensureTriggersAreFocusable()}};if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init)}else{init()}})();